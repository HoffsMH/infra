#!/bin/bash

source $HOME/.envrc

if [ -f "$CAP_FILE" ]; then
  ~/bin/internals/cap.sync
fi

~/bin/internals/cap.dedup-links

if [ -z "$1" ]; then
  term=$(ls $CAP_DIR | ~/bin/internals/cap.get-type | sort -u | fzf)
else
  term="$1"
fi

fd "$term" $CAP_DIR | sort | tail -n 20 | hcat > $CAP_FILE

~/bin/internals/nvim.cap
